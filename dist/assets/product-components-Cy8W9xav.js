import{u as Te,a as he,r as m,F as u,j as e,T as we,S as fe,R as _,C as b,b as z,H as oe,I as ee,W as ke,f as le,G as ue,s as j,O as Pe,e as ge,A as ts,B as O,X as Le,E as ye,c as de,Q as be,_ as De,K as pe,y as as,D as rs,v as Ae}from"./react-core-i1FDzZHP.js";import{c as Re,b as qe,S as ls,A,F as ns,o as Ie,p as is,q as cs,I as h,E as os,f as ds,L as us,s as ms,D as xs,t as Me,v as ze,d as hs,w as ps,x as js}from"./index-B2KmX_8V.js";import"./utility-libs-C6oKIWOz.js";import"./date-utils-DpdzE7my.js";import"./pdf-utils-CVj_c_h-.js";import"./react-state-D-rUAZ-t.js";const{Title:gs,Text:Ne}=we,{TextArea:ys}=ee;function fs(){const x=Te(),{categoriesList:E}=he(c=>c.categories),{productsList:se}=he(c=>c.products),[p,k]=m.useState(""),[I,N]=m.useState(!1),[M,V]=m.useState(null),[F]=u.useForm();m.useEffect(()=>{x(Re()),x(qe())},[x]);const D=E,H=D.filter(c=>c.name.toLowerCase().includes(p.toLowerCase())||c.description?.toLowerCase().includes(p.toLowerCase())),v=async c=>{try{if(D.find(R=>R.name.toLowerCase()===c.name.toLowerCase()&&R.id!==M?.id)){j.error("Category name already exists");return}const Z={id:M?.id||`CAT-${Date.now()}`,name:c.name,description:c.description,isActive:c.isActive!==!1,createdAt:M?.createdAt||new Date};M?(x(Ie({categoryData:Z})),j.success("Category updated successfully")):(x(is({categoryData:Z})),j.success("Category added successfully")),N(!1),V(null),F.resetFields()}catch{j.error("Please fill in all required fields")}},S=c=>{console.log("category modal",c),V(c),F.setFieldsValue(c),N(!0)},ne=c=>{const f=E.find(R=>R.id===c),Z=se.filter(R=>R.category===f?.name);if(Z.length>0){j.error(`Cannot delete category. ${Z.length} product(s) are using this category.`);return}x(cs({categoryId:c})),j.success("Category deleted successfully")},B=c=>{const f={...c,isActive:!c.isActive};x(Ie({categoryData:f})),j.success(`Category ${f.isActive?"activated":"deactivated"}`)},P=c=>se.filter(f=>f.category===c).length,$=[{title:"Category Name",dataIndex:"name",key:"name",render:(c,f)=>e.jsxs("div",{children:[e.jsx(Ne,{strong:!0,className:"text-base",children:f.name}),e.jsx("br",{}),e.jsx(Ne,{type:"secondary",className:"text-sm",children:f.description})]})},{title:"Products",key:"productCount",render:c=>{const f=P(c.name);return e.jsxs(le,{color:f>0?"blue":"default",children:[f," product",f!==1?"s":""]})}},{title:"Status",key:"status",render:c=>e.jsx(ke,{checked:c.isActive,onChange:()=>B(c),size:"small"})},{title:"Created",dataIndex:"createdAt",key:"createdAt",render:c=>new Date(c).toLocaleDateString()},{title:"Actions",key:"actions",render:c=>e.jsxs(fe,{children:[e.jsx(A.Text,{icon:"edit",onClick:()=>S(c),className:"text-[#0E72BD]"}),e.jsx(ue,{title:"Are you sure you want to delete this category?",description:P(c.name)>0?`This category has ${P(c.name)} product(s). Please reassign them first.`:"This action cannot be undone.",onConfirm:()=>ne(c.id),okText:"Yes",cancelText:"No",disabled:P(c.name)>0,children:e.jsx(A.Text,{icon:"delete",danger:!0,disabled:P(c.name)>0})})]})}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(gs,{level:5,className:"m-0",children:"Product Categories"}),e.jsx(Ne,{type:"secondary",children:"Organize your products into categories"})]}),e.jsxs(fe,{children:[e.jsx(ls,{placeholder:"Search categories...",value:p,onSearch:k,className:"w-64"}),e.jsx(A.Primary,{icon:"add",onClick:()=>N(!0),children:"Add Category"})]})]}),e.jsxs(_,{gutter:16,className:"mb-4",children:[e.jsx(b,{span:8,children:e.jsx(z,{size:"small",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[#0E72BD]",children:D.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Categories"})]})})}),e.jsx(b,{span:8,children:e.jsx(z,{size:"small",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:D.filter(c=>c.isActive).length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Active Categories"})]})})}),e.jsx(b,{span:8,children:e.jsx(z,{size:"small",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:se.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Products"})]})})})]}),e.jsx(oe,{columns:$,dataSource:H,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(c,f)=>`${f[0]}-${f[1]} of ${c} items`}})]}),e.jsxs(ns,{title:M?"Edit Category":"Add New Category",open:I,onCancel:()=>{N(!1),V(null),F.resetFields()},onSubmit:v,form:F,width:600,submitText:M?"Update Category":"Add Category",children:[e.jsx(u.Item,{name:"name",label:"Category Name",rules:[{required:!0,message:"Please enter category name"},{min:2,message:"Category name must be at least 2 characters"},{max:50,message:"Category name must be less than 50 characters"}],children:e.jsx(ee,{placeholder:"e.g., Tables, Chairs, Storage"})}),e.jsx(u.Item,{name:"description",label:"Description",rules:[{max:200,message:"Description must be less than 200 characters"}],children:e.jsx(ys,{rows:3,placeholder:"Enter category description (optional)"})}),e.jsx(u.Item,{name:"isActive",label:"Status",valuePropName:"checked",initialValue:!0,children:e.jsx(ke,{})})]})]})}const{Title:ce,Text:C}=we,{Option:bs}=pe,{Panel:ws}=De;function Cs({colors:x=[],rawMaterials:E=[],onAddColor:se,onUpdateColor:p,onRemoveColor:k,onAddColorSize:I,onRemoveColorSize:N,onAddColorMaterial:M,onRemoveColorMaterial:V}){const[F]=u.useForm(),[D]=u.useForm(),[H]=u.useForm(),[v,S]=m.useState(null),[ne,B]=m.useState(null),[P,$]=m.useState(null),[c,f]=m.useState(""),Z=r=>{const l={name:r.name,colorCode:"#000000",image:P||""};se(l),F.resetFields(),$(null)},R=r=>{const l=new FileReader;return l.onload=a=>{$(a.target.result)},l.readAsDataURL(r),!1},Q=r=>{if(!v){j.error("Please select a color first");return}const l={name:r.name,stock:r.stock||0,dimensions:r.dimensions||{},weight:r.weight||0,rawMaterials:[]};I(v,l),D.resetFields()},G=(r,l,a)=>{const y=E.find(n=>n.id===a.materialId);if(!y){j.error("Material not found");return}if(x.find(n=>n.id===r)?.sizes?.find(n=>n.id===l)?.rawMaterials?.find(n=>n.rawMaterialId===a.materialId)){j.error("Material already added to this size");return}const t={rawMaterialId:a.materialId,quantity:a.quantity,name:y.name,unit:y.unit,unitPrice:y.unitPrice},o=x.map(n=>n.id===r?{...n,sizes:n.sizes.map(w=>w.id===l?{...w,rawMaterials:[...w.rawMaterials||[],t]}:w)}:n);p(r,{sizes:o.find(n=>n.id===r).sizes}),H.resetFields(),j.success("Material added to size")},me=(r,l,a)=>{const y=x.map(K=>K.id===r?{...K,sizes:K.sizes.map(Y=>Y.id===l?{...Y,rawMaterials:(Y.rawMaterials||[]).filter(U=>U.rawMaterialId!==a)}:Y)}:K);p(r,{sizes:y.find(K=>K.id===r).sizes}),j.success("Material removed from size")},te=()=>x.find(r=>r.id===v);E.filter(r=>r.name.toLowerCase().includes(c.toLowerCase())||r.category.toLowerCase().includes(c.toLowerCase()));const J=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{size:"small",title:"Add New Color",children:e.jsxs(u,{form:F,layout:"vertical",onFinish:Z,children:[e.jsxs(_,{gutter:16,children:[e.jsx(b,{span:16,children:e.jsx(u.Item,{name:"name",label:"Color Name",rules:[{required:!0,message:"Please enter color name"}],children:e.jsx(ee,{placeholder:"e.g., Natural Oak, Walnut, White"})})}),e.jsx(b,{span:8,children:e.jsx(u.Item,{label:" ",children:e.jsx(O,{type:"primary",htmlType:"submit",icon:e.jsx(h,{name:"add"}),block:!0,children:"Add Color"})})})]}),e.jsx(u.Item,{label:"Color Image (Optional)",children:e.jsx(Le,{accept:"image/*",beforeUpload:R,showUploadList:!1,maxCount:1,children:e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-blue-400 transition-colors cursor-pointer",children:P?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-gray-300",style:{backgroundImage:`url(${P})`,backgroundSize:"cover",backgroundPosition:"center"}})}),e.jsx("div",{children:e.jsx(O,{icon:e.jsx(h,{name:"upload"}),size:"small",children:"Change Image"})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{name:"cloud_upload",className:"text-2xl text-gray-400"}),e.jsxs("div",{children:[e.jsx(C,{children:"Click to upload color image"}),e.jsx("br",{}),e.jsx(C,{type:"secondary",className:"text-sm",children:"Will be displayed as small circle in POS"})]})]})})})})]})}),e.jsxs("div",{children:[e.jsxs(ce,{level:5,className:"mb-4",children:["Product Colors (",x.length,")"]}),x.length===0?e.jsx(ye,{description:"No colors added yet",image:ye.PRESENTED_IMAGE_SIMPLE}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:x.map(r=>e.jsx(z,{size:"small",className:`cursor-pointer transition-all hover:shadow-md ${v===r.id?"border-blue-500 bg-blue-50":""}`,onClick:()=>S(r.id),actions:[e.jsx(de,{title:"Manage Sizes",children:e.jsx(O,{type:"text",icon:e.jsx(h,{name:"straighten"}),onClick:l=>{l.stopPropagation(),S(r.id)},children:"Manage"})},"manage"),e.jsx(ue,{title:"Delete this color?",description:"This will also delete all sizes and raw materials for this color.",onConfirm:l=>{l?.stopPropagation(),k(r.id),v===r.id&&(S(null),B(null))},children:e.jsx(O,{type:"text",danger:!0,icon:e.jsx(h,{name:"delete"}),onClick:l=>l.stopPropagation(),children:"Delete"})},"delete")],children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-gray-300 flex-shrink-0",style:{backgroundImage:r.image?`url(${r.image})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundColor:r.colorCode||"#f0f0f0"},children:!r.image&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(h,{name:"palette",className:"text-gray-400"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(C,{strong:!0,className:"block",children:r.name}),e.jsxs("div",{className:"flex space-x-2 mt-1",children:[e.jsx(ge,{count:r.sizes?.length||0,showZero:!0,style:{backgroundColor:"#722ed1"}}),e.jsx(C,{type:"secondary",className:"text-xs",children:"sizes"}),e.jsx(ge,{count:r.sizes?.reduce((l,a)=>l+(a.rawMaterials?.length||0),0)||0,showZero:!0,style:{backgroundColor:"#fa8c16"}}),e.jsx(C,{type:"secondary",className:"text-xs",children:"materials"})]}),e.jsxs(C,{type:"secondary",className:"text-xs block mt-1",children:["Total Stock: ",r.sizes?.reduce((l,a)=>l+(a.stock||0),0)||0," units"]})]})]})},r.id))})]})]}),ae=()=>{const r=te();return r?e.jsxs("div",{className:"space-y-6",children:[e.jsx(z,{size:"small",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-gray-300",style:{backgroundImage:r.image?`url(${r.image})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundColor:r.colorCode||"#f0f0f0"},children:!r.image&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(h,{name:"palette",className:"text-gray-400"})})}),e.jsxs("div",{children:[e.jsx(ce,{level:4,className:"mb-1",children:r.name}),e.jsxs(C,{type:"secondary",children:[r.sizes?.length||0," size",(r.sizes?.length||0)!==1?"s":""," •",r.sizes?.reduce((l,a)=>l+(a.rawMaterials?.length||0),0)||0," material",(r.sizes?.reduce((l,a)=>l+(a.rawMaterials?.length||0),0)||0)!==1?"s":""]})]})]}),e.jsx(A,{onClick:()=>S(null),icon:"arrow_back",children:"Back to Colors"})]})}),e.jsx(z,{size:"small",title:"Add New Size",children:e.jsx(u,{form:D,layout:"vertical",onFinish:Q,children:e.jsxs(_,{gutter:16,children:[e.jsx(b,{span:8,children:e.jsx(u.Item,{name:"name",label:"Size Name",rules:[{required:!0,message:"Please enter size name"}],children:e.jsx(ee,{placeholder:"e.g., Small, Medium, Large"})})}),e.jsx(b,{span:8,children:e.jsx(u.Item,{name:"stock",label:"Stock Quantity",rules:[{required:!0,message:"Please enter stock quantity"}],children:e.jsx(be,{min:0,placeholder:"0",className:"w-full",step:1})})}),e.jsx(b,{span:8,children:e.jsx(u.Item,{label:" ",children:e.jsx(O,{type:"primary",htmlType:"submit",icon:e.jsx(h,{name:"add"}),block:!0,children:"Add Size"})})})]})})}),e.jsxs("div",{children:[e.jsxs(ce,{level:5,className:"mb-4",children:["Sizes for ",r.name," (",r.sizes?.length||0,")"]}),!r.sizes||r.sizes.length===0?e.jsx(ye,{description:"No sizes added yet",image:ye.PRESENTED_IMAGE_SIMPLE}):e.jsx(De,{accordion:!0,className:"bg-white",expandIcon:({isActive:l})=>e.jsx(h,{name:l?"expand_less":"expand_more"}),children:r.sizes.map(l=>e.jsx(ws,{header:e.jsxs("div",{className:"flex items-center justify-between w-full pr-4",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{children:[e.jsx(C,{strong:!0,className:"text-base",children:l.name}),e.jsx("div",{className:"flex space-x-4 mt-1",children:e.jsxs(C,{type:"secondary",className:"text-sm",children:["Stock: ",l.stock||0," units"]})})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ge,{count:l.rawMaterials?.length||0,showZero:!0,style:{backgroundColor:"#fa8c16"}}),e.jsx(C,{type:"secondary",className:"text-xs",children:"materials"}),e.jsx(ue,{title:"Delete this size?",description:"This will also delete all raw materials for this size.",onConfirm:a=>{a?.stopPropagation(),N(v,l.id),ne===l.id&&B(null)},children:e.jsx(O,{type:"text",danger:!0,icon:e.jsx(h,{name:"delete"}),size:"small",onClick:a=>a.stopPropagation()})})]})]}),extra:null,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx(ce,{level:5,className:"mb-3",children:"Size Specifications"}),e.jsxs(_,{gutter:16,children:[e.jsxs(b,{span:6,children:[e.jsx(C,{type:"secondary",children:"Stock:"}),e.jsx("br",{}),e.jsxs(C,{strong:!0,children:[l.stock||0," units"]})]}),e.jsxs(b,{span:18,children:[e.jsx(C,{type:"secondary",children:"Size Details:"}),e.jsx("br",{}),e.jsxs(C,{strong:!0,children:[l.name," - ",l.stock||0," units in stock"]})]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs(ce,{level:5,className:"mb-0",children:["Raw Materials for ",l.name," (",l.rawMaterials?.length||0,")"]})}),e.jsx(z,{size:"small",className:"mb-4",children:e.jsx(u,{layout:"vertical",onFinish:a=>G(v,l.id,a),children:e.jsxs(_,{gutter:16,children:[e.jsx(b,{span:14,children:e.jsx(u.Item,{name:"materialId",label:"Raw Material",rules:[{required:!0,message:"Please select a material"}],children:e.jsx(pe,{placeholder:"Search and select material",showSearch:!0,optionFilterProp:"label",filterOption:(a,y)=>(y?.label??"").toLowerCase().includes(a.toLowerCase()),children:E?.map(a=>e.jsx(bs,{value:a.id,label:`${a.name} ${a.category}`,children:e.jsxs("div",{children:[e.jsx(C,{strong:!0,children:a.name}),e.jsx("br",{}),e.jsxs(C,{type:"secondary",className:"text-xs",children:[a.category," • LKR ",a.unitPrice,"/",a.unit," • Stock: ",a.stockQuantity]})]})},a.id))})})}),e.jsx(b,{span:6,children:e.jsx(u.Item,{name:"quantity",label:"Quantity Required",rules:[{required:!0,message:"Please enter quantity"}],children:e.jsx(be,{min:.01,step:.01,placeholder:"0.00",className:"w-full"})})}),e.jsx(b,{span:4,children:e.jsx(u.Item,{label:" ",children:e.jsx(O,{type:"primary",htmlType:"submit",icon:e.jsx(h,{name:"add"}),block:!0,children:"Add"})})})]})})}),l.rawMaterials&&l.rawMaterials.length>0?e.jsxs("div",{className:"space-y-2",children:[l.rawMaterials.map((a,y)=>e.jsx("div",{className:"border rounded-lg p-3 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(h,{name:"category",className:"text-orange-600 text-sm"})}),e.jsxs("div",{children:[e.jsx(C,{strong:!0,children:a.name||"Unknown Material"}),e.jsx("br",{}),e.jsxs(C,{type:"secondary",className:"text-sm",children:[a.quantity," ",a.unit||"units"," • LKR ",((a.unitPrice||0)*a.quantity).toFixed(2)," total cost"]})]})]}),e.jsx(ue,{title:"Remove this material?",onConfirm:()=>me(v,l.id,a.rawMaterialId),children:e.jsx(O,{type:"text",danger:!0,icon:e.jsx(h,{name:"delete"}),size:"small"})})]})},`${a.rawMaterialId}-${y}`)),e.jsx("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(C,{strong:!0,children:["Total Material Cost for ",l.name,":"]}),e.jsxs(C,{strong:!0,className:"text-green-600 text-lg",children:["LKR ",l.rawMaterials.reduce((a,y)=>a+(y.unitPrice||0)*y.quantity,0).toFixed(2)]})]})})]}):e.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[e.jsx(h,{name:"category",className:"text-3xl text-gray-300 mb-2"}),e.jsxs(C,{type:"secondary",children:["No raw materials added for ",l.name]}),e.jsx("br",{}),e.jsx(C,{type:"secondary",className:"text-sm",children:"Add raw materials required to manufacture this size"})]})]})]})},l.id))})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(h,{name:"palette",className:"text-4xl text-gray-300 mb-4"}),e.jsx(ce,{level:4,type:"secondary",children:"No Color Selected"}),e.jsx(C,{type:"secondary",children:"Please select a color from the Colors tab to manage its sizes and materials."})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Pe,{activeKey:v?"details":"colors",onChange:r=>{r==="colors"&&(S(null),B(null))},items:[{key:"colors",label:e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx(h,{name:"palette"}),e.jsxs("span",{children:["Colors (",x.length,")"]})]}),children:J()},{key:"details",label:e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx(h,{name:"straighten"}),e.jsx("span",{children:"Sizes & Materials"}),v&&e.jsx(ge,{count:te()?.sizes?.length||0,size:"small",style:{backgroundColor:"#722ed1"}})]}),children:ae(),disabled:!v}]}),x.length===0&&e.jsx(ts,{message:"No Colors Added",description:"Please add at least one color for this product. Each color can have multiple sizes, and each size can have its own raw materials.",type:"info",showIcon:!0})]})}const{Title:Se,Text:L}=we,{Option:Fe}=pe,{TextArea:vs}=ee,{TabPane:zs}=Pe;function Ns({open:x,onClose:E,onSubmit:se,editingProduct:p=null}){const[k,I]=m.useState(0),[N]=u.useForm(),[M]=u.useForm(),[V]=u.useForm(),[F]=u.useForm(),[D,H]=m.useState(!1),[v,S]=m.useState(""),[ne,B]=m.useState([]),[P,$]=m.useState([]),[c,f]=m.useState([]),[Z,R]=m.useState(!1),[Q,G]=m.useState(!1),[me,te]=m.useState(null),[J,ae]=m.useState(null),[r,l]=m.useState({}),[a,y]=m.useState([]),[K,Y]=m.useState(""),{rawMaterialsList:U,error:t}=he(s=>s.rawMaterials),{categoriesList:o}=he(s=>s.categories),n=()=>{const d=N.getFieldsValue().category;if(!d){j.warning("Please select a category first");return}const i=d.split(" ").map(xe=>xe.charAt(0).toUpperCase()).join(""),g=Date.now().toString().slice(-6),T=`${i}${g}`;N.setFieldsValue({barcode:T}),l(xe=>({...xe,barcode:T})),j.success("SKU generated successfully")};m.useEffect(()=>{if(p&&x){const s={name:p.name||"",category:p.category||"",price:p.price||0,barcode:p.barcode||"",description:p.description||"",color:p.color||""};N.setFieldsValue(s),l(s),R(p.hasSizes||!1),G(p.hasAddons||!1),p.colors?y(p.colors):y([]);const d=(p.rawMaterials||[]).map(i=>{const g=U?.find(T=>T.id===i.rawMaterialId);return g?{rawMaterialId:i.rawMaterialId,name:g.name,unit:g.unit,quantity:i.quantity,unitPrice:g.unitPrice||0,totalCost:(g.unitPrice||0)*i.quantity}:{rawMaterialId:i.rawMaterialId,name:"Unknown Material",unit:"unit",quantity:i.quantity||0,unitPrice:0,totalCost:0}});B(d),p.addons?$(p.addons.map(i=>{const g=U?.find(T=>T.id===i.id);return{id:i.id,name:g?.name||i.name,quantity:i.quantity||1,price:i.price||0,unit:g?.unit||"unit"}})):$([]),ae(p.image),I(0)}else if(x&&!p){const s={name:"",category:"",price:0,barcode:"",description:"",color:""};N.resetFields(),l(s),B([]),$([]),y([]),R(!1),G(!1),te(null),ae(null),I(0)}},[p,x,N,U]);const w=()=>{const s=[{title:"Product Details",description:"Basic information",icon:"inventory_2",content:Ye}];return s.push({title:"Colors & Variations",description:"Color variations",icon:"palette",content:Xe}),Q&&s.push({title:"Add-ons",description:"Optional extras",icon:"add_circle",content:es}),s},X=s=>{const d=new FileReader;return d.onload=i=>{ae(i.target.result),l(g=>({...g,image:i.target.result}))},d.readAsDataURL(s),te(s),!1},ie=s=>{const d=U.find(T=>T.id===s.materialId);if(!d){j.error("Material not found");return}if(P.find(T=>T.id===s.materialId)){j.error("Add-on already added");return}const g={id:s.materialId,name:d.name,quantity:s.quantity,price:d.unitPrice*s.quantity,unit:d.unit};$([...P,g]),F.resetFields(),j.success("Add-on added successfully")},Ee=s=>{$(P.filter(d=>d.id!==s)),j.success("Add-on removed")},$e=s=>{const d={id:`COLOR-${Date.now()}`,name:s.name,colorCode:s.colorCode,image:s.image,sizes:[],rawMaterials:[]};y([...a,d]),j.success("Color added successfully")},Ke=(s,d)=>{y(a.map(i=>i.id===s?{...i,...d}:i)),j.success("Color updated successfully")},Ue=s=>{y(a.filter(d=>d.id!==s)),j.success("Color removed successfully")},Oe=(s,d)=>{y(a.map(i=>i.id===s?{...i,sizes:[...i.sizes||[],{id:`SIZE-${Date.now()}`,...d}]}:i)),j.success("Size added to color")},_e=(s,d)=>{y(a.map(i=>i.id===s?{...i,sizes:(i.sizes||[]).filter(g=>g.id!==d)}:i)),j.success("Size removed from color")},Ve=(s,d)=>{y(a.map(i=>i.id===s?{...i,rawMaterials:[...i.rawMaterials||[],d]}:i)),j.success("Material added to color")},Be=(s,d)=>{y(a.map(i=>i.id===s?{...i,rawMaterials:(i.rawMaterials||[]).filter(g=>g.rawMaterialId!==d)}:i)),j.success("Material removed from color")},Qe=(s,d)=>{l(i=>({...i,...d}))},Ge=async()=>{if(S(""),k===0)try{const s=await N.validateFields();l(d=>({...d,...s})),I(k+1)}catch(s){if(s.errorFields&&s.errorFields.length>0){const d=s.errorFields.map(i=>{const g=Array.isArray(i.name)?i.name.join("."):i.name;return{name:"Product Name",category:"Category",price:"Price",stock:"Stock",barcode:"SKU/Barcode",description:"Description",weight:"Weight",color:"Color"}[g]||g});S(`Please fill in the following required fields: ${d.join(", ")}`)}else S("Please fill in all required product details")}else I(k+1)},We=()=>{S(""),I(k-1)},He=async()=>{try{H(!0),S("");const s=N.getFieldsValue(),d={...r,...s},i=["name","category","price"],g=[];if(i.forEach(q=>{const re=d[q];(re==null||re===""||q==="price"&&Number(re)<0)&&g.push(q)}),g.length>0){const q={name:"Product Name",category:"Category",price:"Price"},re=g.map(je=>q[je]||je);S(`Please fill in required fields: ${re.join(", ")}`),I(0);return}if(a.length===0){S("Please add at least one color for this product"),I(1);return}const T=a.filter(q=>!q.sizes||q.sizes.length===0);if(T.length>0){S(`Please add at least one size for color(s): ${T.map(q=>q.name).join(", ")}`),I(1);return}const xe={id:p?.id||`PROD-${Date.now()}`,name:d.name,category:d.category,description:d.description||"",image:J||d.image||"",hasAddons:Q,price:Number(d.price)||0,stock:a.reduce((q,re)=>q+(re.sizes||[]).reduce((je,ss)=>je+(ss.stock||0),0),0),barcode:d.barcode||"",color:d.color||"",material:d.material||"",colors:a,addons:Q?P:[]};await se(xe),Ce()}catch(s){console.error("Error submitting product:",s),S("Failed to save product. Please check all required fields.")}finally{H(!1)}},Ce=()=>{I(0),S(""),N.resetFields(),M.resetFields(),V.resetFields(),F.resetFields(),B([]),$([]),f([]),y([]),G(!1),te(null),ae(null),l({}),E()},Ze=[{title:"Add-on",dataIndex:"name",key:"name"},{title:"Quantity",key:"quantity",render:s=>`${s.quantity||0} ${s.unit||"unit"}`},{title:"Price",dataIndex:"price",key:"price",render:s=>`LKR ${(s||0).toFixed(2)}`},{title:"Actions",key:"actions",render:s=>e.jsx(ue,{title:"Remove this add-on?",onConfirm:()=>Ee(s.id),children:e.jsx(O,{type:"text",danger:!0,icon:e.jsx(h,{name:"delete"}),size:"small"})})}],Je=U.filter(s=>s.name.toLowerCase().includes(K.toLowerCase())||s.category.toLowerCase().includes(K.toLowerCase())),Ye=()=>e.jsxs(u,{form:N,layout:"vertical",className:"space-y-4",onValuesChange:Qe,preserve:!0,children:[e.jsxs(_,{gutter:16,children:[e.jsx(b,{span:16,children:e.jsx(u.Item,{name:"name",label:"Product Name",rules:[{required:!0,message:"Please enter product name"},{min:2,message:"Product name must be at least 2 characters"}],children:e.jsx(ee,{placeholder:"Enter product name"})})}),e.jsx(b,{span:8,children:e.jsx(u.Item,{name:"category",label:"Category",rules:[{required:!0,message:"Please select category"}],children:e.jsx(pe,{placeholder:"Select category",allowClear:!0,children:o?.filter(s=>s.isActive).map(s=>e.jsx(Fe,{value:s.name,children:s.name},s.id))})})})]}),e.jsx(_,{gutter:16,children:e.jsx(b,{span:12,children:e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(L,{strong:!0,children:"Product Add-ons"}),e.jsx("br",{}),e.jsx(L,{type:"secondary",className:"text-sm",children:"Enable if this product has optional add-ons"})]}),e.jsx(ke,{checked:Q,onChange:G,checkedChildren:"Yes",unCheckedChildren:"No"})]})})})}),e.jsx(_,{gutter:16,children:e.jsx(b,{span:24,children:e.jsx(u.Item,{name:"price",label:"Price (LKR)",rules:[{required:!0,message:"Please enter price"},{type:"number",min:.01,message:"Price must be greater than 0"}],children:e.jsx(be,{min:.01,step:100,placeholder:"0.00",className:"w-full",formatter:s=>`LKR ${s}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:s=>s.replace(/LKR\s?|(,*)/g,"")})})})}),e.jsx(_,{gutter:16,children:e.jsx(b,{span:16,children:e.jsx(u.Item,{name:"barcode",label:"SKU/Barcode",children:e.jsx(ee,{placeholder:"Enter SKU or barcode",addonAfter:e.jsx(O,{type:"text",size:"small",onClick:n,icon:e.jsx(h,{name:"auto_awesome"}),className:"text-blue-600",children:"Generate"})})})})}),e.jsx(u.Item,{name:"description",label:"Description",children:e.jsx(vs,{rows:3,placeholder:"Enter product description"})}),e.jsx(u.Item,{label:"Product Image",children:e.jsx(Le,{accept:"image/*",beforeUpload:X,showUploadList:!1,maxCount:1,children:e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors cursor-pointer",children:J?e.jsxs("div",{className:"space-y-2",children:[e.jsx("img",{src:J,alt:"Preview",className:"w-32 h-32 object-cover mx-auto rounded"}),e.jsx("div",{children:e.jsx(O,{icon:e.jsx(h,{name:"upload"}),size:"small",children:"Change Image"})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{name:"cloud_upload",className:"text-4xl text-gray-400"}),e.jsxs("div",{children:[e.jsx(L,{children:"Click to upload product image"}),e.jsx("br",{}),e.jsx(L,{type:"secondary",className:"text-sm",children:"Supports: JPG, PNG, GIF (Max: 5MB)"})]})]})})})})]}),Xe=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Se,{level:5,children:"Product Colors"}),e.jsx(L,{type:"secondary",children:"Define color variations for this product. Each color can have its own sizes and raw materials."})]}),e.jsx(Cs,{colors:a,rawMaterials:U,onAddColor:$e,onUpdateColor:Ke,onRemoveColor:Ue,onAddColorSize:Oe,onRemoveColorSize:_e,onAddColorMaterial:Ve,onRemoveColorMaterial:Be})]}),es=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Se,{level:5,children:"Product Add-ons"}),e.jsx(L,{type:"secondary",children:"Define optional add-ons that customers can select when purchasing this product"})]}),e.jsx(z,{size:"small",children:e.jsxs(u,{form:F,onFinish:ie,layout:"vertical",children:[e.jsx(_,{gutter:16,children:e.jsx(b,{span:24,className:"mb-4",children:e.jsx(ee.Search,{placeholder:"Search materials...",onChange:s=>Y(s.target.value),className:"w-full"})})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:Je.map(s=>e.jsx(z,{size:"small",className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>{F.setFieldsValue({materialId:s.id,quantity:1})},children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(h,{name:"category",className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx(L,{strong:!0,className:"block",children:s.name}),e.jsxs(L,{type:"secondary",className:"text-xs",children:["LKR ",s.unitPrice.toFixed(2)," per ",s.unit]}),e.jsx("br",{}),e.jsxs(L,{type:"secondary",className:"text-xs",children:["Stock: ",s.stockQuantity," ",s.unit]})]})]})},s.id))}),e.jsxs(_,{gutter:16,children:[e.jsx(b,{span:12,children:e.jsx(u.Item,{name:"materialId",label:"Selected Add-on",rules:[{required:!0,message:"Please select an add-on"}],children:e.jsx(pe,{placeholder:"Select add-on material",showSearch:!0,optionFilterProp:"label",filterOption:(s,d)=>(d?.label??"").toLowerCase().includes(s.toLowerCase()),children:U?.map(s=>e.jsxs(Fe,{value:s.id,label:`${s.name} (LKR ${s.unitPrice.toFixed(2)}/${s.unit})`,children:[s.name," (LKR ",s.unitPrice.toFixed(2),"/",s.unit,")"]},s.id))})})}),e.jsx(b,{span:8,children:e.jsx(u.Item,{name:"quantity",label:"Quantity",rules:[{required:!0,message:"Please enter quantity"}],initialValue:1,children:e.jsx(be,{min:1,step:1,placeholder:"1",className:"w-full"})})}),e.jsx(b,{span:4,children:e.jsx(u.Item,{label:" ",children:e.jsx(O,{type:"primary",htmlType:"submit",icon:e.jsx(h,{name:"add"}),block:!0,children:"Add"})})})]})]})}),P.length>0?e.jsxs("div",{children:[e.jsx(Se,{level:5,children:"Selected Add-ons"}),e.jsx(oe,{columns:Ze,dataSource:P,rowKey:"id",pagination:!1,size:"small",summary:s=>{const d=s.reduce((i,g)=>i+(g.price||0),0);return e.jsxs(oe.Summary.Row,{children:[e.jsx(oe.Summary.Cell,{colSpan:2,children:e.jsx(L,{strong:!0,children:"Total Add-on Price"})}),e.jsx(oe.Summary.Cell,{children:e.jsxs(L,{strong:!0,children:["LKR ",d.toFixed(2)]})}),e.jsx(oe.Summary.Cell,{})]})}})]}):e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx(h,{name:"add_circle",className:"text-4xl text-gray-300 mb-2"}),e.jsx(L,{type:"secondary",children:"No add-ons added yet"}),e.jsx("br",{}),e.jsx(L,{type:"secondary",className:"text-sm",children:"Add optional extras that customers can select when purchasing"})]})]}),ve=w();return e.jsx(as,{title:p?"Edit Product":"Add New Product",open:x,onCancel:Ce,width:900,footer:null,destroyOnClose:!0,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(os,{current:k,steps:ve,status:v?"error":"process",errorMessage:v}),e.jsx("div",{className:"min-h-[500px]",children:D?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx(L,{children:"Loading..."})]})}):ve[k].content()}),e.jsx(rs,{}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:k>0&&e.jsxs(A,{onClick:We,children:[e.jsx(h,{name:"arrow_back",className:"mr-2"}),"Previous"]})}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(A,{onClick:Ce,children:"Cancel"}),k<ve.length-1?e.jsxs(A.Primary,{onClick:Ge,children:["Next",e.jsx(h,{name:"arrow_forward",className:"ml-2"})]}):e.jsx(A.Primary,{onClick:He,loading:D,icon:"check",children:p?"Update Product":"Create Product"})]})]})]})})}const{Title:Fs,Text:W}=we,{Search:Ts}=ee;function Ls(){const x=Te(),[E,se]=m.useState(""),[p,k]=m.useState(!1),[I,N]=m.useState(null),[M,V]=m.useState(null),[F,D]=m.useState(!1),[H,v]=m.useState(!1),[S,ne]=m.useState(!1),[B,P]=m.useState("products"),[$,c]=m.useState([]),{productsList:f,error:Z}=he(t=>t.products);m.useEffect(()=>{x(qe()),x(ds()),x(Re())},[x]);const R=f.filter(t=>(t.name||"").toLowerCase().includes(E.toLowerCase())||(t.category||"").toLowerCase().includes(E.toLowerCase())||(t.barcode||"").includes(E)),Q=f.filter(t=>t.stock===0),G=f.filter(t=>t.stock>0&&t.stock<=10),me=f.filter(t=>t.stock>10&&t.stock<=20),te=async t=>{try{ne(!0),I?(x(ps(t)),j.success("Product updated successfully")):(x(js(t)),j.success("Product added successfully")),k(!1),N(null)}catch{j.error("Failed to save product")}finally{ne(!1)}},J=t=>{N(t),k(!0)},ae=t=>{x(Me({productId:t}))},r=t=>{t.forEach(o=>{x(Me({productId:o}))}),j.success(`${t.length} products deleted successfully`),c([])},l=t=>{V(t),D(!0)},a=t=>{V(t),v(!0)},y=[{title:"Product",dataIndex:"name",key:"name",fixed:"left",width:300,render:(t,o)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ae,{src:o.image||"https://images.pexels.com/photos/586344/pexels-photo-586344.jpeg?auto=compress&cs=tinysrgb&w=100",alt:o.name,width:50,height:50,className:"object-cover rounded",preview:!1,style:{aspectRatio:"1/1",objectFit:"cover"}}),e.jsxs("div",{children:[e.jsx(W,{strong:!0,children:o.name}),e.jsx("br",{}),e.jsxs(W,{type:"secondary",className:"text-xs",children:["SKU: ",o.barcode]})]})]})},{title:"Category",dataIndex:"category",key:"category",width:120,render:t=>e.jsx(le,{color:"blue",children:t}),filters:[...new Set(f.map(t=>t.category))].map(t=>({text:t,value:t})),onFilter:(t,o)=>o.category===t},{title:"Price",dataIndex:"price",key:"price",width:120,sorter:(t,o)=>(t.price||0)-(o.price||0),render:(t,o)=>e.jsxs(W,{strong:!0,children:["LKR ",(t||0).toFixed(2)]})},{title:"Stock",dataIndex:"stock",key:"stock",width:120,sorter:(t,o)=>(t.stock||0)-(o.stock||0),render:(t,o)=>e.jsxs(le,{color:t>10?"green":t>0?"orange":"red",children:[t," units"]}),filters:[{text:"In Stock (>10)",value:"in-stock"},{text:"Low Stock (1-10)",value:"low-stock"},{text:"Out of Stock",value:"out-of-stock"}],onFilter:(t,o)=>{const n=o.stock;return t==="in-stock"?n>10:t==="low-stock"?n>0&&n<=10:t==="out-of-stock"?n===0:!0}},{title:"Type",key:"type",width:120,render:t=>t.isCustom?e.jsx(le,{color:"gold",children:"Custom"}):t.colors&&t.colors.length>0?e.jsx(le,{color:"purple",children:"Has Colors"}):e.jsx(le,{color:"default",children:"Single"}),filters:[{text:"Has Colors",value:"colors"},{text:"Single Product",value:"single"},{text:"Custom Product",value:"custom"}],onFilter:(t,o)=>t==="colors"?o.colors&&o.colors.length>0:t==="single"?(!o.colors||o.colors.length===0)&&!o.isCustom:t==="custom"?o.isCustom:!0},{title:"Dimensions",key:"dimensions",width:150,render:t=>{if(t.colors&&t.colors.length>0){const o=t.colors[0]?.sizes?.[0];if(o&&o.dimensions&&o.dimensions.length)return e.jsxs(W,{className:"text-sm",children:[o.dimensions.length,"×",o.dimensions.width,"×",o.dimensions.height," ",o.dimensions.unit]})}return e.jsx(W,{type:"secondary",children:"-"})}},{title:"Actions",key:"actions",fixed:"right",width:100,render:t=>e.jsxs(fe,{children:[e.jsx(de,{title:"Edit",children:e.jsx(A.Text,{icon:"edit",onClick:o=>{o.stopPropagation(),J(t)},className:"text-blue-600"})}),e.jsx(de,{title:"Print Details",children:e.jsx(A.Text,{icon:"print",onClick:o=>{o.stopPropagation(),l(t)},className:"text-gray-600"})}),e.jsx(de,{title:"Delete",children:e.jsx(ue,{title:"Delete this product?",onConfirm:o=>{o?.stopPropagation(),ae(t.id)},okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},children:e.jsx(A.Text,{icon:"delete",danger:!0,onClick:o=>o.stopPropagation()})})})]})}],K=()=>e.jsx("div",{className:"space-y-4",children:e.jsx(ze,{columns:y,dataSource:R,rowKey:"id",onRow:t=>({onClick:()=>a(t),className:"cursor-pointer hover:bg-blue-50"}),searchFields:["name","category","barcode"],searchPlaceholder:"Search products...",showSearch:!0,rowSelection:{type:"checkbox",onChange:t=>c(t)},onDelete:r,extra:e.jsx(A.Primary,{icon:"add",onClick:()=>k(!0),children:"Add Product"}),emptyDescription:"No products found",emptyImage:e.jsx(h,{name:"inventory_2",className:"text-6xl text-gray-300"})})}),Y=()=>{const t=[{title:"Product",dataIndex:"name",key:"name",fixed:"left",width:300,render:(n,w)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ae,{src:w.image||"https://images.pexels.com/photos/586344/pexels-photo-586344.jpeg?auto=compress&cs=tinysrgb&w=100",alt:w.name,width:50,height:50,className:"object-cover rounded",preview:!1,style:{aspectRatio:"1/1",objectFit:"cover"}}),e.jsxs("div",{children:[e.jsx(W,{strong:!0,children:w.name}),e.jsx("br",{}),e.jsxs(W,{type:"secondary",className:"text-xs",children:["SKU: ",w.barcode]})]})]})},{title:"Category",dataIndex:"category",key:"category",width:120,render:n=>e.jsx(le,{color:"blue",children:n})},{title:"Current Stock",dataIndex:"stock",key:"stock",width:120,sorter:(n,w)=>(n.stock||0)-(w.stock||0),render:(n,w)=>{let X="green",ie="In Stock";return n===0?(X="red",ie="Out of Stock"):n<=10?(X="orange",ie="Low Stock"):n<=20&&(X="yellow",ie="Almost Low"),e.jsxs("div",{children:[e.jsxs(W,{strong:!0,className:`text-${X==="red"?"red":X==="orange"?"orange":X==="yellow"?"yellow":"green"}-600`,children:[n," units"]}),e.jsx("br",{}),e.jsx(le,{color:X,size:"small",children:ie})]})}},{title:"Price",dataIndex:"price",key:"price",width:120,sorter:(n,w)=>(n.price||0)-(w.price||0),render:(n,w)=>e.jsxs(W,{strong:!0,children:["LKR ",(n||0).toFixed(2)]})},{title:"Total Value",key:"totalValue",width:120,render:n=>e.jsxs(W,{strong:!0,className:"text-blue-600",children:["LKR ",((n.price||0)*(n.stock||0)).toFixed(2)]}),sorter:(n,w)=>(n.price||0)*(n.stock||0)-(w.price||0)*(w.stock||0)},{title:"Actions",key:"actions",fixed:"right",width:100,render:n=>e.jsxs(fe,{children:[e.jsx(de,{title:"Edit",children:e.jsx(A.Text,{icon:"edit",onClick:w=>{w.stopPropagation(),J(n)},className:"text-blue-600"})}),e.jsx(de,{title:"Print Details",children:e.jsx(A.Text,{icon:"print",onClick:w=>{w.stopPropagation(),l(n)},className:"text-gray-600"})})]})}],o=[...Q.map(n=>({...n,alertType:"out-of-stock"})),...G.map(n=>({...n,alertType:"low-stock"})),...me.map(n=>({...n,alertType:"almost-low"}))];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(_,{gutter:16,className:"mb-6",children:[e.jsx(b,{span:8,children:e.jsxs(z,{size:"small",className:"text-center border-red-200 bg-red-50",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:Q.length}),e.jsx("div",{className:"text-sm text-red-500",children:"Out of Stock"})]})}),e.jsx(b,{span:8,children:e.jsxs(z,{size:"small",className:"text-center border-orange-200 bg-orange-50",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:G.length}),e.jsx("div",{className:"text-sm text-orange-500",children:"Low Stock (≤10)"})]})}),e.jsx(b,{span:8,children:e.jsxs(z,{size:"small",className:"text-center border-yellow-200 bg-yellow-50",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:me.length}),e.jsx("div",{className:"text-sm text-yellow-500",children:"Almost Low (≤20)"})]})})]}),o.length===0?e.jsx(z,{children:e.jsx(hs,{icon:"check_circle",title:"All Products Well Stocked",description:"No stock alerts at this time. All products have adequate inventory levels."})}):e.jsx(ze,{title:"Product Stock Alerts",icon:"warning",subtitle:`${o.length} products need attention`,columns:t,dataSource:o,rowKey:"id",onRow:n=>({onClick:()=>a(n),className:`cursor-pointer hover:bg-blue-50 ${n.alertType==="out-of-stock"?"bg-red-50":n.alertType==="low-stock"?"bg-orange-50":"bg-yellow-50"}`}),searchFields:["name","category","barcode"],searchPlaceholder:"Search products with stock issues...",showSearch:!0,extra:e.jsx(A.Primary,{icon:"add",onClick:()=>k(!0),children:"Add Product"}),emptyDescription:"No stock alerts",emptyImage:e.jsx(h,{name:"check_circle",className:"text-6xl text-green-300"})})]})},U=[{key:"products",label:e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx(h,{name:"inventory_2"}),e.jsx("span",{children:"Products"})]}),children:K()},{key:"stock-alerts",label:e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx(h,{name:"warning"}),e.jsx("span",{children:"Stock Alerts"}),Q.length+G.length>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full px-2 py-1 ml-1",children:Q.length+G.length})]}),children:Y()},{key:"categories",label:e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx(h,{name:"category"}),e.jsx("span",{children:"Categories"})]}),children:e.jsx(fs,{})}];return S?e.jsx(us,{type:"table"}):e.jsxs(e.Fragment,{children:[e.jsx(z,{children:e.jsx(Pe,{activeKey:B,onChange:P,items:U})}),e.jsx(Ns,{open:p,onClose:()=>{k(!1),N(null)},onSubmit:te,editingProduct:I}),e.jsx(ms,{open:F&&!H,onClose:()=>{D(!1),V(null)},product:M}),e.jsx(xs,{open:H,onClose:()=>{v(!1),V(null)},title:`Product Details - ${M?.name}`,icon:"inventory_2",data:M,type:"product",actions:[e.jsx(A,{icon:"edit",onClick:()=>{v(!1),J(M)},children:"Edit Product"},"edit"),e.jsx(A,{icon:"print",onClick:()=>{v(!1),l(M)},children:"Print Details"},"print")]})]})}export{Ls as ProductManagement};
